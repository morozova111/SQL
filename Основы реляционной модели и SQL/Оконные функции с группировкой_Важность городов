/*Важность городов

В одной из прошлых задач мы добавили в таблицу население каждой страны. Теперь давайте посчитаем долю (процент) населения каждого города в общем населении страны.

Напишите SQL запрос, который выводит все столбцы таблицы +2 колонки: одну с общим населением страны, в которой находится город, а вторую с процентом, который текущий город занимает в стране.

Колонка с общим населением должна называться country_population, а с процентом percent. Проценты нужно вывести с округлением до двух знаков после десятичной точки.

Итоговые данные отсортируйте по населению страны и по населению города в возрастающем порядке.
 * 
 */select *, 
sum(population) over (partition by country) as country_population,
round((population/ sum(population) over (partition by country))*100 ,2) as percent
from cities
order by country_population, population
